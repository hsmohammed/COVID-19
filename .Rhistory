ylab("number of cases")+
ggplot()+
geom_line(data = COVID_confirmed %>% dplyr::filter(country == "China"),aes(n_cases,new_cases))+
theme_bw()+
ylab("number of cases")
ggplot()+
geom_line(data = COVID_confirmed %>% dplyr::filter(country == "China"),aes(n_cases,new_cases))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()
ggplot()+
geom_line(data = COVID_confirmed %>% dplyr::filter(country == "China"),aes(n_cases,new_cases))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()
ggplot()+
geom_line(data = COVID_confirmed %>% dplyr::filter(country == "US"),aes(n_cases,new_cases))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()
?scale_y_log10
ggplot()+
geom_line(data = COVID_confirmed %>% dplyr::filter(country == "US"),aes(n_cases,new_cases,color = "US"))+
geom_line(data = COVID_confirmed %>% dplyr::filter(country == "US"),aes(n_cases,new_cases, color = "China"))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()
ggplot()+
geom_line(data = COVID_confirmed %>% dplyr::filter(country == "US"),aes(n_cases,new_cases,color = "US"))+
geom_line(data = COVID_confirmed %>% dplyr::filter(country == "China"),aes(n_cases,new_cases, color = "China"))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()
ggplot()+
geom_line(data = COVID_confirmed %>% dplyr::filter(country == "US"),aes(n_cases,new_cases,color = "US"))+
geom_line(data = COVID_confirmed %>% dplyr::filter(country == "China"),aes(n_cases,new_cases, color = "China"))+
geom_line(data = COVID_confirmed %>% dplyr::filter(country == "Italy"),aes(n_cases,new_cases, color = "Italy"))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()
COVID_confirmed
ggplot()+
geom_line(data = COVID_confirmed %>% dplyr::filter(date %in% c("002-03-01":"002-03-28")) %>% dplyr::filter(country == "US"),aes(n_cases,new_cases,color = "US"))
COVID_confirmed %>% dplyr::filter(date %in% c("002-03-01":"002-03-28"))
c("002-03-01":"002-03-28")
ggplot()+
geom_line(data = COVID_confirmed %>% dplyr::filter(country == "US"),aes(n_cases,new_cases,color = "US"))+
geom_line(data = COVID_confirmed %>% dplyr::filter(country == "China"),aes(n_cases,new_cases, color = "China"))+
geom_line(data = COVID_confirmed %>% dplyr::filter(country == "Italy"),aes(n_cases,new_cases, color = "Italy"))+
geom_line(data = COVID_confirmed %>% dplyr::filter(country == "Spain"),aes(n_cases,new_cases, color = "Spain"))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()+
scale_x_date(limits = c("0020-03-1":"002-03-28"))
ggplot()+
geom_line(data = COVID_confirmed %>% dplyr::filter(country == "US"),aes(n_cases,new_cases,color = "US"))+
geom_line(data = COVID_confirmed %>% dplyr::filter(country == "China"),aes(n_cases,new_cases, color = "China"))+
geom_line(data = COVID_confirmed %>% dplyr::filter(country == "Italy"),aes(n_cases,new_cases, color = "Italy"))+
geom_line(data = COVID_confirmed %>% dplyr::filter(country == "Spain"),aes(n_cases,new_cases, color = "Spain"))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()+
scale_x_date(limits = as.Date(c("0020-03-1","002-03-28")))
ggplot()+
geom_line(data = COVID_confirmed %>% dplyr::filter(country == "US") %>% dplyr::filter(date %in% as.Date(c("002-03-01":"002-03-28"))),aes(n_cases,new_cases,color = "US"))
ggplot()+
geom_line(data = COVID_confirmed %>% dplyr::filter(country == "US") %>% dplyr::filter(date %in% as.Date(c("002-03-01","002-03-28"))),aes(n_cases,new_cases,color = "US"))
ggplot()+
geom_line(data = COVID_confirmed %>% dplyr::filter(country == "US"),aes(n_cases,new_cases,color = "US"))+
geom_line(data = COVID_confirmed %>% dplyr::filter(country == "China"),aes(n_cases,new_cases, color = "China"))+
geom_line(data = COVID_confirmed %>% dplyr::filter(country == "Italy"),aes(n_cases,new_cases, color = "Italy"))+
geom_line(data = COVID_confirmed %>% dplyr::filter(country == "Spain"),aes(n_cases,new_cases, color = "Spain"))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()
ggplot()+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "US"),aes(n_cases,new_cases,color = "US"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "China"),aes(n_cases,new_cases, color = "China"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Italy"),aes(n_cases,new_cases, color = "Italy"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Spain"),aes(n_cases,new_cases, color = "Spain"))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()
ggplot()+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "US")%>% filter(n_cases > 10),aes(n_cases,new_cases,color = "US"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "China")%>% filter(n_cases > 10),aes(n_cases,new_cases, color = "China"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Italy")%>% filter(n_cases > 10),aes(n_cases,new_cases, color = "Italy"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Spain") %>% filter(n_cases > 10),aes(n_cases,new_cases, color = "Spain"))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()
ggplot()+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "US")%>% filter(new_cases > 10),aes(n_cases,new_cases,color = "US"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "China")%>% filter(new_cases > 10),aes(n_cases,new_cases, color = "China"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Italy")%>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Italy"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Spain") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Spain"))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()
ggplot()+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "US")%>% filter(new_cases > 10),aes(n_cases,new_cases,color = "US"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "China")%>% filter(new_cases > 10),aes(n_cases,new_cases, color = "China"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Italy")%>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Italy"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Spain") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Spain"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Korea, South") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Spain"))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()
ggplot()+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "US")%>% filter(new_cases > 10),aes(n_cases,new_cases,color = "US"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "China")%>% filter(new_cases > 10),aes(n_cases,new_cases, color = "China"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Italy")%>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Italy"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Spain") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Spain"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Korea, South") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Spain"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Japan") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Spain"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Canada") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Spain"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "UK") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Spain"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Iran") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Spain"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "France") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Spain"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Egypt") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Spain"))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()
ggplot()+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "US")%>% filter(new_cases > 10),aes(n_cases,new_cases,color = "US"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "China")%>% filter(new_cases > 10),aes(n_cases,new_cases, color = "China"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Italy")%>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Italy"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Spain") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Spain"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Korea, South") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Korea, South"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Japan") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Japan"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Canada") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Canada"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "United Kingdom") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "United Kingdom"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Iran") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Iran"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "France") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "France"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Egypt") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Egypt"))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()
ggplot()+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "US")%>% filter(new_cases > 10),aes(n_cases,new_cases,color = "US"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "China")%>% filter(new_cases > 10),aes(n_cases,new_cases, color = "China"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Italy")%>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Italy"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Spain") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Spain"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Korea, South") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Korea, South"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Japan") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Japan"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Canada") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Canada"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "United Kingdom") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "United Kingdom"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Iran") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Iran"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "France") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "France"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Egypt") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Egypt"), size = 1)+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()
ggplot()+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "US")%>% filter(new_cases > 10),aes(n_cases,new_cases,color = "US"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "China")%>% filter(new_cases > 10),aes(n_cases,new_cases, color = "China"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Italy")%>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Italy"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Spain") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Spain"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Korea, South") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Korea, South"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Japan") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Japan"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Canada") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Canada"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "United Kingdom") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "United Kingdom"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Iran") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Iran"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "France") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "France"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Egypt") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Egypt"), size = 2)+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()
ggplot()+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "US")%>% filter(new_cases > 10),aes(n_cases,new_cases,color = "US"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "China")%>% filter(new_cases > 10),aes(n_cases,new_cases, color = "China"), size = 2)+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Italy")%>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Italy"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Spain") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Spain"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Korea, South") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Korea, South"), size = 2)+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Japan") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Japan"), size = 2)+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Canada") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Canada"), size = 2)+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "United Kingdom") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "United Kingdom"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Iran") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Iran"), size = 2)+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "France") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "France"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Egypt") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Egypt"))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()
ggplot()+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "US")%>% filter(new_cases > 10),aes(n_cases,new_cases,color = "US"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "China")%>% filter(new_cases > 10),aes(n_cases,new_cases, color = "China"), size = 2)+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Italy")%>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Italy"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Spain") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Spain"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Korea, South") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Korea, South"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Japan") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Japan"), size = 2)+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Canada") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Canada"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "United Kingdom") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "United Kingdom"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Iran") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Iran"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "France") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "France"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Egypt") %>% filter(new_cases > 10),aes(n_cases,new_cases, color = "Egypt"))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()
COVID_confirmed_smoothed = COVID_confirmed %>%
dplyr::group_by(country) %>%
dplyr::mutate(new_cases_smoothed = predict(loess(log10(new_cases) ~ log10(n_cases), data=economics, span=0.10)))
COVID_confirmed_smoothed = COVID_confirmed %>%
dplyr::group_by(country) %>%
dplyr::mutate(new_cases_smoothed = predict(loess(new_cases ~ n_cases, span=0.10)))
COVID_confirmed_smoothed
View(COVID_confirmed_smoothed)
View(COVID_confirmed_smoothed)
COVID_confirmed_smoothed = COVID_confirmed %>%
dplyr::group_by(country) %>%
dplyr::mutate(new_cases_smoothed = predict(loess(new_cases ~ n_cases, span=0.10, data = .)))
COVID_confirmed_smoothed = COVID_confirmed %>%
dplyr::group_by(country) %>%
dplyr::mutate(new_cases_smoothed = predict(loess(new_cases ~ n_cases, span=0.10, data = .)))
COVID_confirmed
COVID_confirmed_smoothed = COVID_confirmed %>%
dplyr::group_by(country) %>%
dplyr::mutate(new_cases_smoothed = predict(loess(new_cases ~ n_cases, span=0.50, data = .)))
COVID_confirmed_smoothed <- COVID_confirmed %>%
dplyr::group_by(country)
COVID_confirmed_smoothed
COVID_confirmed_smoothed <- COVID_confirmed %>%
dplyr::group_by(country)
COVID_confirmed_smoothed
COVID_confirmed_smoothed <- COVID_confirmed %>%
dplyr::group_by(country) %>%
dplyr::mutate(new_cases_smoothed = predict(loess(new_cases ~ n_cases, span=0.50, data = .)))
COVID_confirmed_smoothed <- COVID_confirmed %>%
dplyr::group_by(country) %>%
dplyr::mutate(new_cases_smoothed = purrr::map(data = ., loess,
formula = new_cases ~ n_cases, span = .5))
COVID_confirmed_smoothed <- COVID_confirmed %>%
dplyr::group_by(country) %>%
dplyr::mutate(new_cases_smoothed = purrr::map(data = ., .f = loess,
formula = new_cases ~ n_cases, span = .5))
COVID_confirmed
COVID_confirmed_smoothed <- COVID_confirmed %>%
tidyr::nest(-country) %>%
dplyr::mutate(m = purrr::map(data = ., .f = loess,
formula = new_cases ~ n_cases, span = .5),
fitted = purrr::map(m, `[[`, "fitted"))
COVID_confirmed_smoothed <- COVID_confirmed %>%
tidyr::nest(-country) %>%
dplyr::mutate(m = purrr::map(data, loess,
formula = new_cases ~ n_cases, span = .5),
fitted = purrr::map(m, `[[`, "fitted"))
COVID_confirmed_smoothed
COVID_confirmed_smoothed <- COVID_confirmed_smoothed %>%
dplyr::select(-m) %>%
tidyr::unnest()
COVID_confirmed_smoothed
COVID_confirmed_smoothed <- COVID_confirmed %>%
tidyr::nest(-country) %>%
dplyr::mutate(m = purrr::map(data, loess,
formula = new_cases ~ n_cases, span = 1),
fitted = purrr::map(m, `[[`, "fitted"))
COVID_confirmed_smoothed <- COVID_confirmed_smoothed %>%
dplyr::select(-m) %>%
tidyr::unnest()
COVID_confirmed_smoothed
ggplot()+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "US")%>% filter(m > 10),aes(n_cases,m,color = "US"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "China")%>% filter(m > 10),aes(n_cases,m, color = "China"), size = 2)+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Italy")%>% filter(m > 10),aes(n_cases,m, color = "Italy"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Spain") %>% filter(m > 10),aes(n_cases,m, color = "Spain"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Korea, South") %>% filter(m > 10),aes(n_cases,m, color = "Korea, South"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Japan") %>% filter(m > 10),aes(n_cases,m, color = "Japan"), size = 2)+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Canada") %>% filter(m > 10),aes(n_cases,m, color = "Canada"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "United Kingdom") %>% filter(m > 10),aes(n_cases,m, color = "United Kingdom"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Iran") %>% filter(m > 10),aes(n_cases,m, color = "Iran"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "France") %>% filter(m > 10),aes(n_cases,m, color = "France"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Egypt") %>% filter(m > 10),aes(n_cases,m, color = "Egypt"))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()
scale_x_date(date_breaks = "3 days")+
scale_y_continuous(breaks = round(seq(min(df[[country]]), max(df[[country]]), length.out = 15),.10))+
theme(axis.text.x = element_text(angle = 90))+
ggtitle(type)
ggplot()+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "US")%>% filter(m > 10),aes(n_cases,m,color = "US"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "China")%>% filter(m > 10),aes(n_cases,m, color = "China"), size = 2)+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Italy")%>% filter(m > 10),aes(n_cases,m, color = "Italy"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Spain") %>% filter(m > 10),aes(n_cases,m, color = "Spain"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Korea, South") %>% filter(m > 10),aes(n_cases,m, color = "Korea, South"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Japan") %>% filter(m > 10),aes(n_cases,m, color = "Japan"), size = 2)+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Canada") %>% filter(m > 10),aes(n_cases,m, color = "Canada"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "United Kingdom") %>% filter(m > 10),aes(n_cases,m, color = "United Kingdom"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Iran") %>% filter(m > 10),aes(n_cases,m, color = "Iran"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "France") %>% filter(m > 10),aes(n_cases,m, color = "France"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Egypt") %>% filter(m > 10),aes(n_cases,m, color = "Egypt"))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()
COVID_confirmed_smoothed
ggplot()+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "US")%>% filter(fitted > 10),aes(n_cases,fitted,color = "US"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "China")%>% filter(fitted > 10),aes(n_cases,fitted, color = "China"), size = 2)+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Italy")%>% filter(fitted > 10),aes(n_cases,fitted, color = "Italy"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Spain") %>% filter(fitted > 10),aes(n_cases,fitted, color = "Spain"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Korea, South") %>% filter(fitted > 10),aes(n_cases,fitted, color = "Korea, South"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Japan") %>% filter(fitted > 10),aes(n_cases,fitted, color = "Japan"), size = 2)+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Canada") %>% filter(fitted > 10),aes(n_cases,fitted, color = "Canada"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "United Kingdom") %>% filter(fitted > 10),aes(n_cases,fitted, color = "United Kingdom"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Iran") %>% filter(fitted > 10),aes(fitted,fitted, color = "Iran"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "France") %>% filter(fitted > 10),aes(n_cases,fitted, color = "France"))+
geom_path(data = COVID_confirmed %>% dplyr::filter(country == "Egypt") %>% filter(fitted > 10),aes(n_cases,fitted, color = "Egypt"))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()
ggplot()+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "US")%>% filter(fitted > 10),aes(n_cases,fitted,color = "US"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "China")%>% filter(fitted > 10),aes(n_cases,fitted, color = "China"), size = 2)+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Italy")%>% filter(fitted > 10),aes(n_cases,fitted, color = "Italy"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Spain") %>% filter(fitted > 10),aes(n_cases,fitted, color = "Spain"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Korea, South") %>% filter(fitted > 10),aes(n_cases,fitted, color = "Korea, South"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Japan") %>% filter(fitted > 10),aes(n_cases,fitted, color = "Japan"), size = 2)+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Canada") %>% filter(fitted > 10),aes(n_cases,fitted, color = "Canada"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "United Kingdom") %>% filter(fitted > 10),aes(n_cases,fitted, color = "United Kingdom"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Iran") %>% filter(fitted > 10),aes(fitted,fitted, color = "Iran"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "France") %>% filter(fitted > 10),aes(n_cases,fitted, color = "France"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Egypt") %>% filter(fitted > 10),aes(n_cases,fitted, color = "Egypt"))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()
ggplot()+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "US"),aes(n_cases,fitted,color = "US"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "China"),aes(n_cases,fitted, color = "China"), size = 2)+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Italy"),aes(n_cases,fitted, color = "Italy"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Spain"),aes(n_cases,fitted, color = "Spain"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Korea, South"),aes(n_cases,fitted, color = "Korea, South"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Japan"),aes(n_cases,fitted, color = "Japan"), size = 2)+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Canada"),aes(n_cases,fitted, color = "Canada"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "United Kingdom"),aes(n_cases,fitted, color = "United Kingdom"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Iran") ,aes(fitted,fitted, color = "Iran"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "France"),aes(n_cases,fitted, color = "France"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Egypt") ,aes(n_cases,fitted, color = "Egypt"))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()
scale_x_date(date_breaks = "3 days")+
scale_y_continuous(breaks = round(seq(min(df[[country]]), max(df[[country]]), length.out = 15),.10))+
theme(axis.text.x = element_text(angle = 90))+
ggtitle(type)
ggplot()+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "US"),aes(n_cases,fitted,color = "US"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "China"),aes(n_cases,fitted, color = "China"), size = 2)+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Italy"),aes(n_cases,fitted, color = "Italy"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Spain"),aes(n_cases,fitted, color = "Spain"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Korea, South"),aes(n_cases,fitted, color = "Korea, South"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Japan"),aes(n_cases,fitted, color = "Japan"), size = 2)+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Canada"),aes(n_cases,fitted, color = "Canada"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "United Kingdom"),aes(n_cases,fitted, color = "United Kingdom"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Iran") ,aes(fitted,fitted, color = "Iran"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "France"),aes(n_cases,fitted, color = "France"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Egypt") ,aes(n_cases,fitted, color = "Egypt"))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()
ggplot()+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "US"),aes(n_cases,fitted,color = "US"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "China"),aes(n_cases,fitted, color = "China"), size = 2)+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Italy"),aes(n_cases,fitted, color = "Italy"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Spain"),aes(n_cases,fitted, color = "Spain"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Korea, South"),aes(n_cases,fitted, color = "Korea, South"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Japan"),aes(n_cases,fitted, color = "Japan"), size = 2)+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Canada"),aes(n_cases,fitted, color = "Canada"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "United Kingdom"),aes(n_cases,fitted, color = "United Kingdom"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Iran") ,aes(fitted,fitted, color = "Iran"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "France"),aes(n_cases,fitted, color = "France"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Egypt") ,aes(n_cases,fitted, color = "Egypt"))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()+
geom_dl(aes(label = country), method = list(dl.combine("first.points", "last.points"), cex = 0.8))
library(directlabels)
ggplot()+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "US"),aes(n_cases,fitted,color = "US"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "China"),aes(n_cases,fitted, color = "China"), size = 2)+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Italy"),aes(n_cases,fitted, color = "Italy"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Spain"),aes(n_cases,fitted, color = "Spain"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Korea, South"),aes(n_cases,fitted, color = "Korea, South"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Japan"),aes(n_cases,fitted, color = "Japan"), size = 2)+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Canada"),aes(n_cases,fitted, color = "Canada"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "United Kingdom"),aes(n_cases,fitted, color = "United Kingdom"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Iran") ,aes(fitted,fitted, color = "Iran"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "France"),aes(n_cases,fitted, color = "France"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Egypt") ,aes(n_cases,fitted, color = "Egypt"))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()+
geom_dl(aes(label = country), method = list(dl.combine("first.points", "last.points"), cex = 0.8))
country
ggplot()+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "US"),aes(n_cases,fitted,color = "US"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "China"),aes(n_cases,fitted, color = "China"), size = 2)+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Italy"),aes(n_cases,fitted, color = "Italy"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Spain"),aes(n_cases,fitted, color = "Spain"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Korea, South"),aes(n_cases,fitted, color = "Korea, South"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Japan"),aes(n_cases,fitted, color = "Japan"), size = 2)+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Canada"),aes(n_cases,fitted, color = "Canada"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "United Kingdom"),aes(n_cases,fitted, color = "United Kingdom"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Iran") ,aes(fitted,fitted, color = "Iran"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "France"),aes(n_cases,fitted, color = "France"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Egypt") ,aes(n_cases,fitted, color = "Egypt"))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()+
geom_dl(data = COVID_confirmed_smoothed, aes(label = country), method = list(dl.combine("first.points", "last.points"), cex = 0.8))
ggplot(data = COVID_confirmed_smoothed, aes(n_cases, fitted))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "US"),aes(n_cases,fitted,color = "US"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "China"),aes(n_cases,fitted, color = "China"), size = 2)+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Italy"),aes(n_cases,fitted, color = "Italy"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Spain"),aes(n_cases,fitted, color = "Spain"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Korea, South"),aes(n_cases,fitted, color = "Korea, South"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Japan"),aes(n_cases,fitted, color = "Japan"), size = 2)+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Canada"),aes(n_cases,fitted, color = "Canada"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "United Kingdom"),aes(n_cases,fitted, color = "United Kingdom"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Iran") ,aes(fitted,fitted, color = "Iran"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "France"),aes(n_cases,fitted, color = "France"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Egypt") ,aes(n_cases,fitted, color = "Egypt"))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()+
geom_dl(data = COVID_confirmed_smoothed, aes(label = country), method = list(dl.combine("first.points", "last.points"), cex = 0.8))
library(directlabels)
COVID_confirmed_smoothed2 <- COVID_confirmed_smoothed %>%
dplyr::filter(country %in% c("US", "China", "Italy", "Spain", "Korea, South", "Japan", "Canada", "United Kingdom", "Iran","France", "Egypt"))
ggplot(data = COVID_confirmed_smoothed, aes(n_cases, fitted))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "US"),aes(n_cases,fitted,color = "US"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "China"),aes(n_cases,fitted, color = "China"), size = 2)+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Italy"),aes(n_cases,fitted, color = "Italy"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Spain"),aes(n_cases,fitted, color = "Spain"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Korea, South"),aes(n_cases,fitted, color = "Korea, South"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Japan"),aes(n_cases,fitted, color = "Japan"), size = 2)+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Canada"),aes(n_cases,fitted, color = "Canada"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "United Kingdom"),aes(n_cases,fitted, color = "United Kingdom"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Iran") ,aes(fitted,fitted, color = "Iran"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "France"),aes(n_cases,fitted, color = "France"))+
geom_path(data = COVID_confirmed_smoothed %>% dplyr::filter(country == "Egypt") ,aes(n_cases,fitted, color = "Egypt"))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()+
geom_dl(data = COVID_confirmed_smoothed, aes(label = country), method = list(dl.combine("first.points", "last.points"), cex = 0.8))
library(directlabels)
COVID_confirmed_smoothed2 <- COVID_confirmed_smoothed %>%
dplyr::filter(country %in% c("US", "China", "Italy", "Spain", "Korea, South", "Japan", "Canada", "United Kingdom", "Iran","France", "Egypt"))
ggplot(data = COVID_confirmed_smoothed2, aes(n_cases, fitted))+
geom_path(data = COVID_confirmed_smoothed2 %>% dplyr::filter(country == "US"),aes(n_cases,fitted,color = "US"))+
geom_path(data = COVID_confirmed_smoothed2 %>% dplyr::filter(country == "China"),aes(n_cases,fitted, color = "China"), size = 2)+
geom_path(data = COVID_confirmed_smoothed2 %>% dplyr::filter(country == "Italy"),aes(n_cases,fitted, color = "Italy"))+
geom_path(data = COVID_confirmed_smoothed2 %>% dplyr::filter(country == "Spain"),aes(n_cases,fitted, color = "Spain"))+
geom_path(data = COVID_confirmed_smoothed2 %>% dplyr::filter(country == "Korea, South"),aes(n_cases,fitted, color = "Korea, South"))+
geom_path(data = COVID_confirmed_smoothed2 %>% dplyr::filter(country == "Japan"),aes(n_cases,fitted, color = "Japan"), size = 2)+
geom_path(data = COVID_confirmed_smoothed2 %>% dplyr::filter(country == "Canada"),aes(n_cases,fitted, color = "Canada"))+
geom_path(data = COVID_confirmed_smoothed2 %>% dplyr::filter(country == "United Kingdom"),aes(n_cases,fitted, color = "United Kingdom"))+
geom_path(data = COVID_confirmed_smoothed2 %>% dplyr::filter(country == "Iran") ,aes(fitted,fitted, color = "Iran"))+
geom_path(data = COVID_confirmed_smoothed2 %>% dplyr::filter(country == "France"),aes(n_cases,fitted, color = "France"))+
geom_path(data = COVID_confirmed_smoothed2 %>% dplyr::filter(country == "Egypt") ,aes(n_cases,fitted, color = "Egypt"))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()+
geom_dl(data = COVID_confirmed_smoothed2, aes(label = country), method = list(dl.combine("first.points", "last.points"), cex = 0.8))
library(directlabels)
COVID_confirmed_smoothed2 <- COVID_confirmed_smoothed %>%
dplyr::filter(country %in% c("US", "China", "Italy", "Spain", "Korea, South", "Japan", "Canada", "United Kingdom", "Iran","France", "Egypt"))
ggplot(data = COVID_confirmed_smoothed2, aes(n_cases, fitted))+
geom_path(data = COVID_confirmed_smoothed2 %>% dplyr::filter(country == "US"),aes(n_cases,fitted,color = "US"))+
geom_path(data = COVID_confirmed_smoothed2 %>% dplyr::filter(country == "China"),aes(n_cases,fitted, color = "China"))+
geom_path(data = COVID_confirmed_smoothed2 %>% dplyr::filter(country == "Italy"),aes(n_cases,fitted, color = "Italy"))+
geom_path(data = COVID_confirmed_smoothed2 %>% dplyr::filter(country == "Spain"),aes(n_cases,fitted, color = "Spain"))+
geom_path(data = COVID_confirmed_smoothed2 %>% dplyr::filter(country == "Korea, South"),aes(n_cases,fitted, color = "Korea, South"))+
geom_path(data = COVID_confirmed_smoothed2 %>% dplyr::filter(country == "Japan"),aes(n_cases,fitted, color = "Japan"))+
geom_path(data = COVID_confirmed_smoothed2 %>% dplyr::filter(country == "Canada"),aes(n_cases,fitted, color = "Canada"))+
geom_path(data = COVID_confirmed_smoothed2 %>% dplyr::filter(country == "United Kingdom"),aes(n_cases,fitted, color = "United Kingdom"))+
geom_path(data = COVID_confirmed_smoothed2 %>% dplyr::filter(country == "Iran") ,aes(fitted,fitted, color = "Iran"))+
geom_path(data = COVID_confirmed_smoothed2 %>% dplyr::filter(country == "France"),aes(n_cases,fitted, color = "France"))+
geom_path(data = COVID_confirmed_smoothed2 %>% dplyr::filter(country == "Egypt") ,aes(n_cases,fitted, color = "Egypt"))+
theme_bw()+
ylab("number of cases")+
scale_y_log10()+
scale_x_log10()+
geom_dl(data = COVID_confirmed_smoothed2, aes(label = country), method = list(dl.combine("first.points", "last.points"), cex = 0.8))
